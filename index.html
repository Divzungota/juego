<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ahorcado LAM ‚Äî Rework</title>
<style>
    :root{
    --bg1:#0f172a; /* slate-900 */
    --bg2:#111827; /* gray-900 */
    --card:#0b1220ea;
    --acc:#7c3aed; /* violet-600 */
    --acc-2:#22d3ee; /* cyan-400 */
    --good:#22c55e; /* green-500 */
    --bad:#ef4444; /* red-500 */
    --muted:#9ca3af; /* gray-400 */
}
  *{box-sizing:border-box}
  body{
    margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;
    background: radial-gradient(1100px 600px at 20% -10%, #1f2937 0%, transparent 60%),
                radial-gradient(1000px 600px at 120% 10%, #0b1020 0%, transparent 60%),
                linear-gradient(135deg, var(--bg1), var(--bg2));
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    color:#e5e7eb; /* gray-200 */
    padding:24px;}
    .container{
    width:min(1100px,100%);
    display:grid;grid-template-columns: 1.1fr 1fr;gap:18px;}
    @media (max-width: 980px){
    .container{grid-template-columns:1fr}}
    .card{
    background:var(--card); backdrop-filter: blur(8px);
    border:1px solid #1f2937; border-radius:20px; padding:18px 18px 20px;
    box-shadow:0 10px 30px rgba(0,0,0,.35);}
    h1{margin:0 0 6px;font-size:clamp(22px,2.6vw,30px)}
    .sub{color:var(--muted);margin:0 0 14px;font-size:14px}

  /* Hangman */
  .gallows{position:relative;height:260px;border-radius:16px;background: #0a0f1a;
           border:1px dashed #1f2937;overflow:hidden}
  .beam, .post, .base, .rope, .head, .body, .arm-l, .arm-r, .leg-l, .leg-r{
    position:absolute;background:#94a3b8; /* slate-400 */
  }
  .base{height:10px;width:70%;left:10%;bottom:16px;border-radius:6px}
  .post{width:12px;height:80%;left:18%;bottom:26px;border-radius:6px}
  .beam{height:12px;width:45%;left:18%;top:28px;border-radius:6px}
  .rope{width:4px;height:38px;left:61%;top:40px;background:#cbd5e1}
  .head{width:48px;height:48px;border-radius:50%;left:58%;top:78px;background:#e5e7eb;display:none}
  .body{width:8px;height:70px;left:61.2%;top:128px;background:#e5e7eb;display:none}
  .arm-l,.arm-r,.leg-l,.leg-r{width:8px;height:46px;background:#e5e7eb;display:none}
  .arm-l{left:57.5%;top:142px;transform:rotate(45deg);transform-origin:top}
  .arm-r{left:64.7%;top:142px;transform:rotate(-45deg);transform-origin:top}
  .leg-l{left:58.5%;top:192px;transform:rotate(35deg);transform-origin:top}
  .leg-r{left:63.7%;top:192px;transform:rotate(-35deg);transform-origin:top}
  .pulse{position:absolute;inset:0;background:radial-gradient(600px 220px at 70% 35%, rgba(124,58,237,.15), transparent 45%)}

  /* Word & UI */
  .word{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:10px}
  .slot{width:40px;height:54px;border-radius:12px;border:1px solid #263143;
        display:grid;place-items:center;font-size:26px;background:#0b1324}
  .controls{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:10px}
  .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:600}
  .btn.primary{background:linear-gradient(135deg,var(--acc),#4f46e5);color:white}
  .btn.ghost{background:transparent;border:1px solid #263143;color:#cbd5e1}
  .lives{font-variant-numeric:tabular-nums}
  .kbd{display:inline-flex;align-items:center;justify-content:center;min-width:28px;padding:6px 8px;border-radius:10px;border:1px solid #263143;background:#0b1324}

  /* Keyboard */
  .keyboard{display:grid;grid-template-columns: repeat(13, 1fr);gap:8px;margin-top:12px}
  .key{border:1px solid #263143;background:#0b1324;border-radius:10px;padding:10px 0;text-align:center;cursor:pointer;user-select:none}
  .key:hover{border-color:#334155}
  .key.used{opacity:.45;cursor:not-allowed}
  .key.good{background:rgba(34,197,94,.18);border-color:rgba(34,197,94,.45)}
  .key.bad{background:rgba(239,68,68,.18);border-color:rgba(239,68,68,.45)}

  /* Panel derecho */
  .panel h3{margin:0 0 8px}
  .list{display:flex;flex-wrap:wrap;gap:8px}
  .chip{border:1px solid #263143;background:#0b1324;border-radius:999px;padding:6px 10px;font-size:12px;color:#cbd5e1}

  /* Modal */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(2,6,23,.6);backdrop-filter:blur(4px);z-index:50}
  .modal.show{display:grid}
  .modal-card{width:min(680px,92vw);background:#0b1220;border:1px solid #263143;border-radius:20px;padding:18px}
  .q-title{font-weight:700;margin:0 0 6px;font-size:18px}
  .q-desc{color:#9ca3af;margin:0 0 12px;font-size:14px}
  .options{display:grid;gap:8px}
  .opt{border:1px solid #263143;background:#0b1324;border-radius:12px;padding:10px;cursor:pointer}
  .opt:hover{border-color:#334155}
  .row{display:grid;grid-template-columns:1fr 160px;gap:8px;align-items:center}
  select{background:#0b1324;border:1px solid #263143;color:#e5e7eb;border-radius:10px;padding:8px}
  .result-banner{margin-top:10px;padding:10px;border-radius:12px;display:none}
  .result-banner.ok{display:block;background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.45)}
  .result-banner.err{display:block;background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.45)}

  .toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#0b1324;border:1px solid #263143;color:#cbd5e1;border-radius:12px;padding:10px 14px;display:none}
  .toast.show{display:block}

</style>
</head>
<body>
  <div class="container">
    <!-- Zona de juego -->
    <section class="card">
      <h1>üéØ Ahorcado LAM</h1>
      <p class="sub">Forma palabras relacionadas con <strong>Modelos de Lenguaje Marcado (LAM)</strong>. Si fallas una letra, tendr√°s que responder un reto (selecci√≥n m√∫ltiple o emparejamiento). ¬°Si completas la palabra: <strong>Buena</strong>! üòé</p>

      <div class="gallows" aria-hidden="true">
        <div class="pulse"></div>
        <div class="base"></div>
        <div class="post"></div>
        <div class="beam"></div>
        <div class="rope"></div>
        <div class="head" id="hm-head"></div>
        <div class="body" id="hm-body"></div>
        <div class="arm-l" id="hm-arm-l"></div>
        <div class="arm-r" id="hm-arm-r"></div>
        <div class="leg-l" id="hm-leg-l"></div>
        <div class="leg-r" id="hm-leg-r"></div>
      </div>

      <div class="word" id="word"></div>

      <div class="controls">
        <div class="lives"><span class="kbd">‚ù§Ô∏è</span> Vidas: <span id="lives">6</span></div>
        <button class="btn ghost" id="hintBtn" title="Muestra una pista">Pista</button>
        <button class="btn primary" id="restartBtn">Nuevo juego</button>
      </div>

      <div class="keyboard" id="keyboard"></div>
    </section>

    <!-- Panel lateral: glosario y progreso -->
    <aside class="card panel">
      <h3>Glosario LAM (palabras posibles)</h3>
      <div class="list" id="vocab"></div>
      <hr style="border-color:#1f2937;margin:14px 0" />
      <h3>Progreso</h3>
      <p class="sub">Aciertos: <span id="hits">0</span> ¬∑ Retos superados: <span id="challenges">0</span></p>
      <p class="sub">Pista actual: <em id="hint">‚Äî</em></p>
    </aside>
  </div>

  <!-- Modal de retos -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <div id="modalContent">
        <!-- Se inyecta din√°micamente -->
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Buena üéâ</div>

<script>
(() => {
  // ======= DATA =======
  const WORDS = [
    { w:"ETIQUETA", hint:"Marcador que indica el tipo de informaci√≥n." },
    { w:"CONTEXTO", hint:"Entorno que da sentido al texto." },
    { w:"MARCADO",  hint:"Uso de etiquetas dentro del texto." },
    { w:"ANOTACION", hint:"Proceso de etiquetar datos con significado." },
    { w:"ENTIDAD", hint:"Objeto nombrado: persona, lugar, organizaci√≥n‚Ä¶" },
    { w:"TOKEN", hint:"Unidad m√≠nima de texto tras el preprocesamiento." },
    { w:"PARSEO", hint:"An√°lisis estructural del texto (parse)." },
    { w:"ONTOLOGIA", hint:"Esquema formal de conceptos y relaciones." },
    { w:"NLP", hint:"Procesamiento de Lenguaje Natural." },
    { w:"LAM", hint:"Modelo de Lenguaje Marcado." },
  ];

  const ABC = [
    'A','B','C','D','E','F','G','H','I','J','K','L','M','N','√ë','O','P','Q','R','S','T','U','V','W','X','Y','Z'
  ];

  const MCQ = [
    {
      q:"¬øQu√© es una etiqueta en LAM?",
      options:[
        {t:"Un decorado del texto", ok:false},
        {t:"Un marcador que tipifica informaci√≥n", ok:true},
        {t:"Un emoji", ok:false},
      ]
    },
    {
      q:"¬øPara qu√© sirve el marcado en textos?",
      options:[
        {t:"Para cambiar el color del fondo", ok:false},
        {t:"Para estructurar y a√±adir sem√°ntica", ok:true},
        {t:"Para acortar palabras", ok:false},
      ]
    },
    {
      q:"¬øCu√°l es un ejemplo de etiqueta?",
      options:[
        {t:"<nombre>Juan</nombre>", ok:true},
        {t:"Juan 12345", ok:false},
        {t:"#SoloHashtag", ok:false},
      ]
    },
  ];

  // Matching con selects (tres pares por reto)
  const MATCH_BANK = [
    { left:"Etiqueta", right:"Marca especial que indica informaci√≥n." },
    { left:"Texto marcado", right:"Texto que contiene etiquetas." },
    { left:"Contexto", right:"Entorno que da sentido a algo." },
    { left:"IA", right:"Sistema que aprende y razona." },
    { left:"NLP", right:"T√©cnicas para entender lenguaje humano." },
    { left:"Entidad", right:"Objeto nombrado (persona, lugar‚Ä¶)." },
    { left:"Ontolog√≠a", right:"Esquema formal de conceptos/relaciones." },
  ];

  // ======= STATE =======
  let target = null;         // {w, hint}
  let revealed = [];         // boolean[] por letra
  let lives = 6;
  let hits = 0;
  let challenges = 0;
  let used = new Set();

  // ======= DOM =======
  const elWord = document.getElementById('word');
  const elKeyboard = document.getElementById('keyboard');
  const elLives = document.getElementById('lives');
  const elHits = document.getElementById('hits');
  const elChal = document.getElementById('challenges');
  const elVocab = document.getElementById('vocab');
  const elHint = document.getElementById('hint');
  const elRestart = document.getElementById('restartBtn');
  const elHintBtn = document.getElementById('hintBtn');
  const elModal = document.getElementById('modal');
  const elModalContent = document.getElementById('modalContent');
  const toast = document.getElementById('toast');

  const parts = [
    document.getElementById('hm-head'),
    document.getElementById('hm-body'),
    document.getElementById('hm-arm-l'),
    document.getElementById('hm-arm-r'),
    document.getElementById('hm-leg-l'),
    document.getElementById('hm-leg-r'),
  ];

  function rand(arr){return arr[Math.floor(Math.random()*arr.length)]}

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]]=[a[j],a[i]];
    }
    return a;
  }

  function newGame(){
    target = rand(WORDS);
    revealed = new Array(target.w.length).fill(false);
    lives = 6; hits = 0; challenges = 0; used = new Set();
    elLives.textContent = lives; elHits.textContent = hits; elChal.textContent = challenges;
    elHint.textContent = '‚Äî';
    parts.forEach(p=>p.style.display='none');
    drawWord();
    drawKeyboard();
  }

  function drawWord(){
    elWord.innerHTML = '';
    [...target.w].forEach((ch,i) => {
      const d = document.createElement('div'); d.className='slot';
      d.textContent = revealed[i] || !ABC.includes(ch) ? ch : '';
      elWord.appendChild(d);
    });
  }

  function drawKeyboard(){
    elKeyboard.innerHTML = '';
    ABC.forEach(ch => {
      const k = document.createElement('div');
      k.className = 'key';
      k.textContent = ch;
      if(used.has(ch)) k.classList.add('used');
      k.addEventListener('click', () => onKey(ch, k));
      elKeyboard.appendChild(k);
    });
  }

  function revealLetter(ch){
    let gained = 0;
    [...target.w].forEach((c, i) => {
      if(!revealed[i] && c === ch){ revealed[i] = true; gained++; }
    });
    if(gained>0){
      hits += gained; elHits.textContent = hits; drawWord();
      if(revealed.every(v=>v)) win();
    }
  }

  function onKey(ch, keyEl){
    if(used.has(ch) || lives<=0) return;
    used.add(ch);
    const present = target.w.includes(ch);
    keyEl.classList.add('used');

    if(present){ keyEl.classList.add('good'); revealLetter(ch); }
    else{
      keyEl.classList.add('bad');
      // Lanzar reto; si falla el reto, pierde vida.
      askChallenge().then(ok=>{
        if(ok){
          // perdona la vida
          flashBanner(true, '¬°Salvaste la vida con el reto!');
        }else{
          loseLife();
        }
      });
    }
  }

  function loseLife(){
    lives--; elLives.textContent = lives;
    const idx = 5 - lives; // 0..5
    if(parts[idx]) parts[idx].style.display='block';
    if(lives<=0) return gameOver();
  }

  function win(){
    toast.textContent = 'Buena üéâ';
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'), 2000);
    // Bloquear teclado
    [...elKeyboard.children].forEach(k=>k.classList.add('used'));
  }

  function gameOver(){
    showModal(`<h3 class="q-title">Fin del juego</h3>
               <p class="q-desc">La palabra era <strong>${target.w}</strong>. ¬øIntentas de nuevo?</p>
               <div style="display:flex;gap:8px;justify-content:flex-end">
                 <button class="btn ghost" id="closeOver">Cerrar</button>
                 <button class="btn primary" id="again">Nuevo juego</button>
               </div>`);
    document.getElementById('closeOver').onclick=hideModal;
    document.getElementById('again').onclick=()=>{ hideModal(); newGame(); };
  }

  // ======= RETOS =======
  function askChallenge(){
    return new Promise((resolve)=>{
      const type = Math.random()<0.5 ? 'mcq' : 'match';
      if(type==='mcq') renderMCQ(resolve); else renderMatch(resolve);
    });
  }

  function renderMCQ(done){
    const item = rand(MCQ);
    const opts = item.options.map((o,i)=>`<div class="opt" data-i="${i}">${o.t}</div>`).join('');
    showModal(`
      <h3 class="q-title">Reto: Selecci√≥n m√∫ltiple</h3>
      <p class="q-desc">Responde correctamente para no perder una vida.</p>
      <div style="margin:8px 0 10px;font-weight:700">${item.q}</div>
      <div class="options" id="opts">${opts}</div>
      <div id="ban" class="result-banner"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button class="btn ghost" id="skip">Rendirse</button>
      </div>
    `);
    const ban = document.getElementById('ban');
    const optsEl = document.getElementById('opts');
    const skip = document.getElementById('skip');

    optsEl.querySelectorAll('.opt').forEach((el)=>{
      el.onclick = ()=>{
        const ok = item.options[+el.dataset.i].ok;
        if(ok){
          ban.className='result-banner ok'; ban.textContent='¬°Correcto!';
          challenges++; elChal.textContent = challenges;
          setTimeout(()=>{ hideModal(); done(true); }, 500);
        }else{
          ban.className='result-banner err'; ban.textContent='Incorrecto :(';
          setTimeout(()=>{ hideModal(); done(false); }, 500);
        }
      };
    });
    skip.onclick=()=>{ hideModal(); done(false); };
  }

  function renderMatch(done){
    // Tomar 3 pares al azar
    const pairs = shuffle(MATCH_BANK).slice(0,3);
    const rights = shuffle(pairs.map(p=>p.right));
    const rows = pairs.map((p,i)=>{
      const options = rights.map(r=>`<option>${r}</option>`).join('');
      return `<div class="row"><div>${p.left}</div><div><select data-left="${p.left}">${options}</select></div></div>`;
    }).join('');

    showModal(`
      <h3 class="q-title">Reto: Emparejamiento</h3>
      <p class="q-desc">Relaciona cada concepto con su definici√≥n para no perder una vida.</p>
      <div id="rows" class="options">${rows}</div>
      <div id="ban" class="result-banner"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button class="btn ghost" id="skip">Rendirse</button>
        <button class="btn primary" id="submit">Comprobar</button>
      </div>
    `);

    const submit = document.getElementById('submit');
    const skip = document.getElementById('skip');
    const ban = document.getElementById('ban');

    submit.onclick = ()=>{
      let allGood = true;
      document.querySelectorAll('#rows select').forEach(sel=>{
        const left = sel.getAttribute('data-left');
        const correct = MATCH_BANK.find(p=>p.left===left).right;
        if(sel.value !== correct) allGood = false;
      });
      if(allGood){
        ban.className='result-banner ok'; ban.textContent='¬°Perfecto!';
        challenges++; elChal.textContent = challenges;
        setTimeout(()=>{ hideModal(); done(true); }, 500);
      }else{
        ban.className='result-banner err'; ban.textContent='Hay errores. :(';
        setTimeout(()=>{ hideModal(); done(false); }, 500);
      }
    };
    skip.onclick = ()=>{ hideModal(); done(false); };
  }

  // ======= MODAL UTILS =======
  function showModal(html){
    elModalContent.innerHTML = html;
    elModal.classList.add('show');
  }
  function hideModal(){ elModal.classList.remove('show'); }

  // ======= UI MISC =======
  function flashBanner(ok, msg){
    const b = document.createElement('div');
    b.className = `result-banner ${ok?'ok':'err'}`;
    b.style.position='absolute'; b.style.top='10px'; b.style.right='10px';
    b.textContent = msg;
    document.body.appendChild(b);
    setTimeout(()=>b.remove(), 1200);
  }

  // Pista simple: muestra hint de la palabra actual
  elHintBtn.addEventListener('click', ()=>{
    elHint.textContent = target.hint;
  });

  // Reiniciar
  elRestart.addEventListener('click', newGame);

  // Pintar vocab chips
  elVocab.innerHTML = WORDS.map(x=>`<span class="chip">${x.w}</span>`).join('');

  // INIT
  newGame();
})();
</script>
</body>
</html>
